<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –≤–∏—Ç—Ä–∞—Ç –ø–∞–ª–∏–≤–∞ ‚Äî –ö–æ–º–∞–Ω–¥–∏—Ä—Å—å–∫–∏–π</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #1c1c1c;
        color: #e0e0e0;
    }

    .calculator {
        max-width: 600px;
        margin: 20px auto;
        padding: 15px;
    }

    .field-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background-color: #2f3e2f;
        border-radius: 12px;
        padding: 8px 12px;
        margin-bottom: 10px;
        box-shadow: 0 3px 6px rgba(0,0,0,0.5);
        flex-wrap: wrap;
    }

    .field-row label {
        flex: 1;
        font-size: 18px;
        color: #b8d2a3;
        margin-right: 10px;
        min-width: 120px;
    }

    .field-row input[type="text"],
    .field-row input[type="number"],
    .field-row input[type="date"] {
        flex: 1;
        max-width: 50%;
        padding: 8px;
        font-size: 18px;
        border-radius: 8px;
        border: 1px solid #555;
        background-color: #1e1e1e;
        color: #fff;
    }

    .field-row input::placeholder {
        color: #888;
    }

    .error-star {
        color: red;
        margin-left: 4px;
    }

    .buttons {
        display: flex;
        justify-content: space-between;
        margin-top: 15px;
        flex-wrap: wrap;
        gap: 8px;
    }

    button {
        flex: 1;
        padding: 12px;
        font-size: 18px;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        color: #fff;
        background: linear-gradient(145deg, #4a5b3a, #7fa34a);
        box-shadow: 2px 2px 6px rgba(0,0,0,0.7);
        transition: 0.2s;
        min-width: 100px;
    }

    button:hover {
        transform: translateY(-2px);
        box-shadow: 4px 4px 8px rgba(0,0,0,0.8);
    }

    #resultv {
        margin-top: 20px;
        font-size: 18px;
        word-break: break-word;
        color: #d1e8b2;
        text-align: center;
    }

    @media (max-width: 480px) {
        .field-row label {
            font-size: 16px;
            min-width: 100px;
        }
        .field-row input {
            font-size: 16px;
            max-width: 50%;
            padding: 8px;
        }
        button {
            font-size: 16px;
            padding: 10px;
        }
    }
</style>
</head>
<body>
<div class="calculator">
<h1 style="text-align:center; color:#b8d2a3;">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –≤–∏—Ç—Ä–∞—Ç –ø–∞–ª–∏–≤–∞</h1>

<div class="field-row">
    <label>üìÖ –í–∏–±–µ—Ä—ñ—Ç—å –¥–∞—Ç—É</label>
    <input type="date" id="date">
</div>

<div class="field-row">
    <label id="crewLabel">üë• –ù–æ–º–µ—Ä –µ–∫—ñ–ø–∞–∂—É</label>
    <input type="text" id="crewNumber" placeholder="–í–≤–µ–¥—ñ—Ç—å –Ω–æ–º–µ—Ä –µ–∫—ñ–ø–∞–∂—É">
</div>

<div class="field-row">
    <label id="prevFuelLabel">üîã –ó–∞–ª–∏—à–æ–∫ –ø–∞–ª–∏–≤–∞</label>
    <input type="number" id="previousFuel" placeholder="–ª">
</div>

<div class="field-row">
    <label id="fuelRecLabel">‚õΩ –ü—Ä–∏—Ö–æ–¥ –ø–∞–ª–∏–≤–∞</label>
    <input type="number" id="fuelReceived" placeholder="–ª" value="0">
  </div>

<div class="field-row">
    <label id="startLabel">üî∞ –°–ø—ñ–¥–æ–º–µ—Ç—Ä –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π</label>
    <input type="number" id="startSpeedometer" placeholder="–∫–º">
</div>

<div class="field-row">
    <label id="endLabel">üèÅ –ö—ñ–Ω—Ü–µ–≤–∏–π —Å–ø—ñ–¥–æ–º–µ—Ç—Ä</label>
    <input type="number" id="endSpeedometer" placeholder="–∫–º">
</div>

<div class="field-row">
    <label id="highwayLabel">üöó –ö–æ–ª–æ–Ω–∞ +10%</label>
    <input type="number" id="highwayDistance" placeholder="–∫–º" value="0">
</div>
 
<div class="field-row">
    <label id="streetLabel">üõ£Ô∏è –¢—Ä–∞—Å–∞ -15%</label>
    <input type="number" id="streetDistance" placeholder="–∫–º">
</div>

<div class="field-row">
    <label id="offroadLabel">üåæ –ë–µ–∑–¥–æ—Ä—ñ–∂–∂—è +30%</label>
    <input type="number" id="offroadDistance" placeholder="–∫–º">
</div>

<div class="buttons">
    <button onclick="calculate()">üßÆ –†–µ–∑—É–ª—å—Ç–∞—Ç</button>
    <button onclick="shareResultv()">üì§ –ü–æ—à–∏—Ä–∏—Ç–∏</button>
    <button onclick="copyResult()">üìã –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏</button>
    <button onclick="window.history.back()">üè† –ú–µ–Ω—é</button>
</div>

<p id="resultv"></p>

<script>
// –î–∞—Ç–∞ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: –ø–æ—Ç–æ—á–Ω–∞ + 1 –¥–µ–Ω—å
    var now = new Date();
    var timeZoneOffset = 120; // +02:00 –ö–∏—ó–≤
    var kievTime = new Date(now.getTime() + (timeZoneOffset*60*1000));
    // –î–æ–¥–∞—î–º–æ –æ–¥–∏–Ω –¥–µ–Ω—å
    kievTime.setDate(kievTime.getDate() + 1);
    var formattedDate = kievTime.toISOString().substr(0,10);
    document.getElementById('date').value = formattedDate;
// –ü—ñ–¥–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–±–µ—Ä–µ–∂–µ–Ω–∏—Ö –¥–∞–Ω–∏—Ö
if(localStorage.getItem('crewNumber')) {
    document.getElementById('crewNumber').value = localStorage.getItem('crewNumber');
}
if(localStorage.getItem('previousFuel')) {
    document.getElementById('previousFuel').value = localStorage.getItem('previousFuel');
}
if(localStorage.getItem('fuelReceived')) {
    document.getElementById('fuelReceived').value = localStorage.getItem('fuelReceived');
}
    if(localStorage.getItem('startSpeedometer')) {
    document.getElementById('startSpeedometer').value = localStorage.getItem('startSpeedometer');
}
if(localStorage.getItem('highwayDistance=0')) {
    document.getElementById('highwayDistance').value = localStorage.getItem('highwayDistance');
}
// if(localStorage.getItem('streetDistance')) {
//    document.getElementById('streetDistance').value = localStorage.getItem('streetDistance');
//}
// if(localStorage.getItem('offroadDistance')) {
//    document.getElementById('offroadDistance').value = localStorage.getItem('offroadDistance');
// —Ä}

// –ú–∞—Å–∏–≤ –ø–æ–ª—ñ–≤ —ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏—Ö –ª–µ–π–±–ª—ñ–≤ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏
const fields = [
    {id: 'crewNumber', label: 'crewLabel'},
    {id: 'previousFuel', label: 'prevFuelLabel'},
    {id: 'fuelReceived', label: 'fuelRecLabel'},
    {id: 'startSpeedometer', label: 'startLabel'},
    {id: 'endSpeedometer', label: 'endLabel'},
    {id: 'highwayDistance', label: 'highwayLabel'},
    {id: 'streetDistance', label: 'streetLabel'},
    {id: 'offroadDistance', label: 'offroadLabel'}
];

function formatDate(inputDate) {
    var dateParts = inputDate.split("-");
    return dateParts[2] + "-" + dateParts[1] + "-" + dateParts[0];
}

function calculate() {
    let allValid = true;

    // –û—á–∏—â–∞—î–º–æ —Å—Ç–∞—Ä—ñ –∑—ñ—Ä–æ—á–∫–∏
    fields.forEach(f => {
        document.getElementById(f.label).innerHTML = document.getElementById(f.label).innerText.replace(' *', '');
    });

    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏—Å–ª–æ–≤–∏—Ö –ø–æ–ª—ñ–≤ —Ç–∞ –Ω–æ–º–µ—Ä–∞ –µ–∫—ñ–ø–∞–∂—É
    fields.forEach(f => {
        const val = document.getElementById(f.id).value.trim();
        if (val === '' || (f.id !== 'crewNumber' && isNaN(parseFloat(val)))) {
            document.getElementById(f.label).innerHTML += ' <span class="error-star">*</span>';
            allValid = false;
        }
    });

    if (!allValid) {
        alert('–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å –≤—Å—ñ —á–∏—Å–ª–æ–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è');
        return;
    }

    var date = document.getElementById('date').value;
    var crewNumber = document.getElementById('crewNumber').value;
    var previousFuel = parseFloat(document.getElementById('previousFuel').value);
    var fuelReceived = parseFloat(document.getElementById('fuelReceived').value);
    var startSpeedometer = parseFloat(document.getElementById('startSpeedometer').value);
    var endSpeedometer = parseFloat(document.getElementById('endSpeedometer').value);
    var highwayDistance = parseFloat(document.getElementById('highwayDistance').value);
    var streetDistance = parseFloat(document.getElementById('streetDistance').value);
    var offroadDistance = parseFloat(document.getElementById('offroadDistance').value);

    var difference = endSpeedometer - startSpeedometer;
    var totalDistance = highwayDistance + streetDistance + offroadDistance;

    if (difference !== totalDistance) {
        alert('–†—ñ–∑–Ω–∏—Ü—è —Å–ø—ñ–¥–æ–º–µ—Ç—Ä–∞ –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Å—É–º—ñ –≤—ñ–¥—Å—Ç–∞–Ω–µ–π –¥–æ—Ä—ñ–≥');
        return;
    }

    var highwayFuel = Math.round((highwayDistance / 100) * 15.9 * 1.10);
    var streetFuel = Math.round((streetDistance / 100) * 15.9 * 0.85);
    var offroadFuel = Math.round((offroadDistance / 100) * 15.9 * 1.30);
    var totalFuel = highwayFuel + streetFuel + offroadFuel;

    var remainingFuel = previousFuel - totalFuel + fuelReceived;

    var formattedDate = formatDate(date);
    var resultv = formattedDate + "_‚Ññ" + crewNumber + "_" + previousFuel + "–ª_–∑–∞–ø—Ä–∞–≤–∫–∞ " + fuelReceived + "–ª_" + endSpeedometer + "_" + difference + "–∫–º_–∫–æ–ª–æ–Ω–∞ " + highwayDistance + "–∫–º_—Ç—Ä–∞—Å–∞ " + streetDistance + "–∫–º_–±–µ–∑–¥–æ—Ä—ñ–∂–∂—è " + offroadDistance + "–∫–º_" + totalFuel + "–ª_" + remainingFuel + "–ª";

    document.getElementById('resultv').innerText = resultv;

    // –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö
    localStorage.setItem('crewNumber', crewNumber);
    localStorage.setItem('previousFuel', remainingFuel);
    localStorage.setItem('startSpeedometer', endSpeedometer);
    localStorage.setItem('highwayDistance', highwayDistance);
    localStorage.setItem('streetDistance', streetDistance);
    localStorage.setItem('offroadDistance', offroadDistance);
}

function shareResultv() {
    var resultTextv = document.getElementById('resultv').innerText;
    if (navigator.share) {
        navigator.share({text: resultTextv}).catch(err => alert('–ü–æ–º–∏–ª–∫–∞: ' + err));
    } else {
        alert('–û–±–º—ñ–Ω –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π –Ω–∞ —Ü—å–æ–º—É –ø—Ä–∏—Å—Ç—Ä–æ—ó');
    }
}

function copyResult() {
    var resultTextv = document.getElementById('resultv').innerText;
    if(resultTextv) {
        navigator.clipboard.writeText(resultTextv)
        .then(() => alert('–†–µ–∑—É–ª—å—Ç–∞—Ç —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ'))
        .catch(err => alert('–ü–æ–º–∏–ª–∫–∞ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è: ' + err));
    } else {
        alert('–ù–µ–º–∞—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É –¥–ª—è –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è');
    }
}
</script>
</body>
</html>
